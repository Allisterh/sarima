<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fit extended SARIMA models — sarima • sarima</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Fit extended SARIMA models — sarima" />
<meta property="og:description" content="

Fit extended SARIMA models, which can include lagged exogeneous
  variables, general unit root non-stationary factors, multiple
  periodicities, and multiplicative terms in the SARIMA
  specification. The models are specified with a flexible formula syntax
  and contain as special cases many models with specialised names, such
  as ARMAX and reg-ARIMA." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sarima</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.8.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/GeoBosh/sarima/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit extended SARIMA models</h1>
    
    <div class="hidden name"><code>sarima.Rd</code></div>
    </div>

    <div class="ref-description">
    

<p>Fit extended SARIMA models, which can include lagged exogeneous
  variables, general unit root non-stationary factors, multiple
  periodicities, and multiplicative terms in the SARIMA
  specification. The models are specified with a flexible formula syntax
  and contain as special cases many models with specialised names, such
  as ARMAX and reg-ARIMA.</p>
    </div>

    <pre class="usage"><span class='fu'>sarima</span><span class='op'>(</span><span class='va'>model</span>, data <span class='op'>=</span> <span class='cn'>NULL</span>, ss.method <span class='op'>=</span> <span class='st'>"sarima"</span>, use.symmetry <span class='op'>=</span> <span class='cn'>FALSE</span>, 
       SSinit <span class='op'>=</span> <span class='st'>"Rossignol2011"</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>model</th>
      <td><p>a model formula specifying the model.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>a list or data frame, usually can be omitted.</p></td>
    </tr>
    <tr>
      <th>ss.method</th>
      <td><p>state space engine to use, defaults to
    <code>"sarima"</code>. (<strong>Note:</strong> this argument will
    probably be renamed.)</p></td>
    </tr>
    <tr>
      <th>use.symmetry</th>
      <td><p>a logical argument indicating whether 
    symmetry should be used to estimate the unit polynomial.</p></td>
    </tr>
    <tr>
      <th>SSinit</th>
      <td><p>method to use for computation of the stationary part of
    the initial covariance matrix, one of "Rossignol2011", "gnb",
    "Gardner1980".</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    

<p><code>sarima</code> fits extended SARIMA models, which can include
  exogeneous variables, general unit root non-stationary factors and
  multiplicative terms in the SARIMA specification.</p>
<p>Let \(\{Y_t\}\) be a time series and \(f(t)\) and \(g(t)\) be
  functions of time and/or (possibly lagged) exogeneous variables.</p>

<p>An extended pure SARIMA model for \(Y_t\) can be written with the
  help of the backward shift operator as
  $$U(B)\Phi(B)Y_t = \Theta(B)\varepsilon_t,$$
  where \(\{\varepsilon_t\}\) is white noise, and 
  \(U(z)\), \(\Phi(z)\), and \(\Theta(z)\) are polynomials,
  such that all roots of \(U(z)\) are on the unit circle, while the
  roots of \(\Phi(z)\) and \(\Theta(z)\) are outside the unit
  circle. If unit roots are missing, ie \(U(z)\equiv 1\), the
  model is stationary with mean zero.</p>
<p>A reg-SARIMA or X-SARIMA model can be defined as a regression with
  SARIMA residuals: 
  $$Y_t = f(t) + Y^c_t$$
  $$U(B)\Phi(B)Y^c_t = \Theta(B)\varepsilon_t,$$
  where \(Y^c_t = Y_t - f(t)\) is the centred \(Y_t\).
  This can be written equivalently as a single equation:
  $$U(B)\Phi(B)(Y_t - f(t)) = \Theta(B)\varepsilon_t.$$
  The regression function \(f(t)\) can depend on
  time and/or (possibly lagged) exogeneous variables.  We call it
  centering function. If \(Y^c_t\) is stationary with mean zero,
  <code>f(t)</code> is the mean of \(Y_t\). If <code>f(t)</code> is constant, say
  <code>mu</code>, \(Y_t\) is stationary with mean <code>mu</code>. Note that the
  two-equation form above shows that in that case <code>mu</code> is the
  intercept in the first equation, so it is perfectly reasonable to
  refer to it also as intercept but to avoid confusion we reserve
  the term <strong>intercept</strong> for  <code>g(t)</code> below.</p>
<p>If the SARIMA part is stationary, then \(EY_t = f(t)\), so
  \(f(t)\) can be interpreted as trend. In this case the above
  specification is often referred to as <strong>mean corrected form</strong> of
  the model.</p>
<p>An alternative way to specify the regression part is to add the
  regression function, say \(\{g(t)\}\), to the right-hand side of the SARIMA
  equation:
  $$U(B)\Phi(B)Y_t = g(t) + \Theta(B)\varepsilon_t.$$
  In the stationary case this is the classical ARMAX specification. 
  This can be written in two-stage form in various ways, eg
  $$U(B)\Phi(B)Y_t = (1 - \Theta(B))\varepsilon_t + u_t,$$
  $$u_t = g(t) + \varepsilon_t .$$
  So, in a sense, g(t) is a trend associated with the residuals from the
  SARIMA modelling. We refer to this form as intercept form of the
  model (as opposed to the mean-corrected form discussed previously).</p>
<p>In general, if there are no exogeneous variables the mean-corrected
  model is equivalent to some intercept model, which gives some
  justification of the terminology, as well. If there are exogeneous
  variables equivalence may be achievable but at the expense of
  introducing more lags in the model, whish is not desirable in general.</p>  
<p>Some examples of equivalence. Let Y be a stationary SARIMA
  process (\(U(z)=1\)) with mean \(\mu\). Then the
  mean-corrected form of the SARIMA model is 
  $$\Phi(B)(Y_t - \mu) = \Theta(B)\varepsilon_t,$$
  while the intercept form is
  $$\Phi(B)Y_t = c + \Theta(B)\varepsilon_t,$$
  where \(c = \Phi(B)\mu\). So, in this case the mean-corrected model
  X-SARIMA model with \(f(t) = \mu\) is equivalent to the
  intercept model with \(g(t) = \Phi(B)\mu\).</p>
<p>As another example, with \(f(t) = bt\), the mean-corrected model is
  \((1-B)(Y_t - bt) = \varepsilon_t\). Expanding the left-hand side
  we obtain the intercept form  \((1-B)Y_t = b + \varepsilon_t\),
  which demonstrates that \(Y_t\) is a random walk with drift \(g(t) = b\).</p>
<p><strong>Model specification</strong></p>
<p>Argument <code>model</code> specifies the model with a syntax similar to
  other model fitting functions in <span style="R">R</span>.  A formula can be given for each
  of the components discussed above as <code>y ~ f | SARIMA | g</code>, where
  <code>f</code>, <code>SARIMA</code> and <code>g</code> are model formulas giving the
  specifications for the centering function <code>f</code>, the <code>SARIMA</code>
  specification, and the intercept function <code>g</code>.  In normal use
  only one of <code>f</code> or <code>g</code> will be different from zero. <code>f</code>
  should always be given (use <code>0</code> to specify that it is identical
  to zero), but <code>g</code> can be omitted altogether.  Sometimes we refer
  to the terms specified by <code>f</code> and <code>g</code> by <code>xreg</code> and
  <code>regx</code>, respectively.</p>
<p><strong>Model formulas for trends and exogeneous regressions</strong>
  <!-- % \strong{The trend parts} of the model (xreg and regx): --></p>  
<p>The formulas for the centering and intercept (ie <code>f</code> and
  <code>g</code>) use the same syntax as in linear models with some additional
  functions for trigonometric trends, polynomial trends and lagged
  variables.</p>
<p>Here are the available specialised terms:</p>  
<p></p><dl>

    <dt>.p(d)</dt><dd><p>Orthogonal polynomials over <code>1:length(y)</code> of degree d
      (starting from degree 1, no constant).</p></dd>
    
    <dt>t</dt><dd><p>Stands for <code>1:length(y)</code>. Note that powers need to be
      protected by I(), e.g. <code>y ~ 1 + .t + I(.t^2)</code>.</p></dd>

    <dt>.cs(s, k)</dt><dd><p>cos/sin pair for the k-th harmonic of 2pi/s. Use vector k to
      specify several harmonics.</p></dd>
    
    <dt>.B(x, lags)</dt><dd><p>Include lagged terms of x, \(B^{lags}(x[t]) = x[t - lags]\).
      <code>lags</code> can be a vector.
      If <code>x</code> is a matrix, the specified lags are taken from each
      column.</p></dd>
  
</dl>
  
  

<p><strong>Model formulas for SARIMA models</strong></p>
<p>A flexible syntax is provided for the specification of the SARIMA part
  of the model.  It is formed using a number of primitives for
  stationary and unit root components, which have 
  non-seasonal and seasonal variants. Arbitrary number of multiplicative
  factors and multiple seasonalities can be specified.</p>  
<p>The SARIMA part of the model can contain any of the following
  terms. They can be repeated as needed. The first argument for all
  seasonal operators is the number of seasons.</p>
<p></p><dl>

    <dt>ar(p)</dt><dd><p>autoregression term of order p</p></dd>
    <dt>ma(q)</dt><dd><p>moving average term of order q</p></dd>

    <dt>sar(s,p)</dt><dd><p>seasonal autoregression term (s seasons, order p)</p></dd>
    <dt>sma(s,q)</dt><dd><p>seasonal moving average term (s seasons, order q)</p></dd>

    <dt>i(d)</dt><dd><p>\((1-B)^d\)</p></dd>
    <dt>s(seas)</dt><dd><p>summation operator,
      \((1 + B + \cdots + B^{seas -1})\)</p></dd>


    <dt>u(x)</dt><dd><p>quadratic unit root term, corresponding to a complex pair on the
      unit circle. If \(x\) is real, it specifies the argument of one
      of the roots as a fraction of \(2\pi\). If \(z\) is
      complex, it is the root itself.      The real roots of modulus one (1 and \(-1\)) should be specified
      using <code>i(1)</code> and <code>s(2)</code>, which correspond to \(1-B\)
      and \(1+B\), respectively.</p></dd>

    <dt>su(s, h)</dt><dd><p>quadratic unit root terms corresponding to seasonal
      differencing factors. h specifies the desired harmonic which
      should be one of 1,2, ..., [s/2]. Several harmonics can be
      specified by setting h to a vector.</p></dd>    


    <dt>ss(s, p)</dt><dd><p>seasonal summation operator,
      \((1 + B^s + \cdots + B^{(s-1)p})\)</p></dd>
  
</dl>

<p>Terms with parameters can contain additional arguments specifying
  initial values, fixed parameters, and transforms. For <code>ar</code>,
  <code>ma</code>, <code>sar</code>, <code>sma</code>, values of the coefficients can be
  specified by an unnamed argument after the parameters given in the
  descriptions above. In estimation these values will be taken as
  initial values for optimisation.  By default, all coefficients are
  taken to be non-fixed.</p>
<p>Argument <code>fixed</code> can be used to fix some of them.  If it is a
  logical vector it should be of length one or have the same length as
  the coefficients. If <code>fixed</code> is of length one and <code>TRUE</code>, all
  coefficients are fixed. If FALSE, all are non-fixed. Otherwise, the
  TRUE/FALSE values in <code>fixed</code> determine the fixedness of the
  corresponding coefficients.</p>
<p><code>fixed</code> can also be a vector of positive integer numbers
  specifying the indices of fixed coefficients, the rest are non-fixed.</p>
<p>Sometimes it may be easier to declare more (e.g. all) coefficients as
  fixed and then `unfix' selectively. Argument <code>nonfixed</code> can be
  used to mark some coefficients as non-fixed after they have been
  declared fixed. Its syntax is the same as for <code>fixed</code>.</p>
<p>TODO: streamline "atanh.tr"</p>
<p>TODO: describe <code>SSinit</code></p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>an object from S3 class Sarima</p>  
<p>(<strong>Note:</strong> the format of the object is still under development
  and may change; use accessor functions, such as <code><a href='https://rdrr.io/r/stats/coef.html'>coef()</a></code>, where provided.)</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Georgi N. Boshnakov</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Currently the implementation of the intercept form (ie the third
    part of the model formula) is incomplete.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/r/stats/arima.html'>arima</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## AirPassengers example</span>
<span class='co'>## fit the classic airline model using arima()</span>
<span class='va'>ap.arima</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/arima.html'>arima</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>AirPassengers</span><span class='op'>)</span>, order <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>)</span>, seasonal <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>## samemodel using twoequivalent ways to specify it</span>
<span class='va'>ap.baseA</span> <span class='op'>&lt;-</span> <span class='fu'>sarima</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>AirPassengers</span><span class='op'>)</span> <span class='op'>~</span> 
                   <span class='fl'>0</span> <span class='op'>|</span> <span class='fu'>ma</span><span class='op'>(</span><span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.3</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>sma</span><span class='op'>(</span><span class='fl'>12</span>,<span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>i</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>si</span><span class='op'>(</span><span class='fl'>12</span>,<span class='fl'>1</span><span class='op'>)</span>, 
                   ss.method <span class='op'>=</span> <span class='st'>"base"</span><span class='op'>)</span>
<span class='va'>ap.baseB</span> <span class='op'>&lt;-</span> <span class='fu'>sarima</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>AirPassengers</span><span class='op'>)</span> <span class='op'>~</span> 
                   <span class='fl'>0</span> <span class='op'>|</span> <span class='fu'>ma</span><span class='op'>(</span><span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.3</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>sma</span><span class='op'>(</span><span class='fl'>12</span>,<span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>i</span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>s</span><span class='op'>(</span><span class='fl'>12</span><span class='op'>)</span>, 
                   ss.method <span class='op'>=</span> <span class='st'>"base"</span><span class='op'>)</span>

<span class='va'>ap.baseA</span>
</div><div class='output co'>#&gt; *Sarima model*
#&gt; Call:
#&gt; sarima(model = log(AirPassengers) ~ 0 | ma(1, c(-0.3)) + sma(12, 1, c(-0.1)) + 
#&gt;     i(1) + si(12, 1), ss.method = "base")
#&gt; 
#&gt; Unit root terms:
#&gt;      (1 - B)(1 - B^12)
#&gt; 
#&gt; Coefficients:
#&gt;           ma1     sma1
#&gt;       -0.4015  -0.5615
#&gt; s.e.   0.1072   0.1068
#&gt; 
#&gt; sigma^2 estimated as 0.001347:  log likelihood = 169.3,  aic = -332.61</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>ap.baseA</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; sarima(model = log(AirPassengers) ~ 0 | ma(1, c(-0.3)) + sma(12, 
#&gt;     1, c(-0.1)) + i(1) + si(12, 1), ss.method = "base")
#&gt; 
#&gt; Model:  Y_t - xreg_t is SarimaX
#&gt;   xreg:    log(AirPassengers) ~ 0 
#&gt;   sarima:  ~ma(1, c(-0.3)) + sma(12, 1, c(-0.1)) + i(1) + si(12, 1) 
#&gt;   regx:    0 
#&gt; 
#&gt; Unit root terms:
#&gt;      (1 - B)(1 - B^12)
#&gt; 
#&gt; Coefficients:
#&gt;      Estimate Std. Error Z value  Pr(&gt;|z|)    
#&gt; ma1  -0.40153    0.10716 -3.7472 0.0001788 ***
#&gt; sma1 -0.56154    0.10680 -5.2581 1.456e-07 ***
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; 
#&gt; estimated sigma^2 = 0.00135,  log-likelihood = 169.3,  aic = -332.61</div><div class='input'><span class='va'>ap.baseB</span>
</div><div class='output co'>#&gt; *Sarima model*
#&gt; Call:
#&gt; sarima(model = log(AirPassengers) ~ 0 | ma(1, c(-0.3)) + sma(12, 1, c(-0.1)) + 
#&gt;     i(2) + s(12), ss.method = "base")
#&gt; 
#&gt; Unit root terms:
#&gt;      (1 - B)^2(1 + B + ... + B^11)
#&gt; 
#&gt; Coefficients:
#&gt;           ma1     sma1
#&gt;       -0.4015  -0.5615
#&gt; s.e.   0.1072   0.1068
#&gt; 
#&gt; sigma^2 estimated as 0.001347:  log likelihood = 169.3,  aic = -332.61</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>ap.baseB</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; sarima(model = log(AirPassengers) ~ 0 | ma(1, c(-0.3)) + sma(12, 
#&gt;     1, c(-0.1)) + i(2) + s(12), ss.method = "base")
#&gt; 
#&gt; Model:  Y_t - xreg_t is SarimaX
#&gt;   xreg:    log(AirPassengers) ~ 0 
#&gt;   sarima:  ~ma(1, c(-0.3)) + sma(12, 1, c(-0.1)) + i(2) + s(12) 
#&gt;   regx:    0 
#&gt; 
#&gt; Unit root terms:
#&gt;      (1 - B)^2(1 + B + ... + B^11)
#&gt; 
#&gt; Coefficients:
#&gt;      Estimate Std. Error Z value  Pr(&gt;|z|)    
#&gt; ma1  -0.40153    0.10716 -3.7472 0.0001788 ***
#&gt; sma1 -0.56154    0.10680 -5.2581 1.456e-07 ***
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; 
#&gt; estimated sigma^2 = 0.00135,  log-likelihood = 169.3,  aic = -332.61</div><div class='input'>
<span class='co'>## as above, but drop 1-B from the model:</span>
<span class='va'>ap2.arima</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/arima.html'>arima</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>AirPassengers</span><span class='op'>)</span>, order <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span>, seasonal <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>ap2.baseA</span> <span class='op'>&lt;-</span> <span class='fu'>sarima</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>AirPassengers</span><span class='op'>)</span> <span class='op'>~</span> 
                    <span class='fl'>0</span> <span class='op'>|</span> <span class='fu'>ma</span><span class='op'>(</span><span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.3</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>sma</span><span class='op'>(</span><span class='fl'>12</span>,<span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>     <span class='fu'>si</span><span class='op'>(</span><span class='fl'>12</span>,<span class='fl'>1</span><span class='op'>)</span>, 
                    ss.method <span class='op'>=</span> <span class='st'>"base"</span><span class='op'>)</span>
<span class='va'>ap2.baseB</span> <span class='op'>&lt;-</span> <span class='fu'>sarima</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>AirPassengers</span><span class='op'>)</span> <span class='op'>~</span> 
                    <span class='fl'>0</span> <span class='op'>|</span> <span class='fu'>ma</span><span class='op'>(</span><span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.3</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>sma</span><span class='op'>(</span><span class='fl'>12</span>,<span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>i</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>s</span><span class='op'>(</span><span class='fl'>12</span><span class='op'>)</span>, 
                    ss.method <span class='op'>=</span> <span class='st'>"base"</span><span class='op'>)</span>

<span class='co'>## for illustration, here the non-stationary part is </span>
<span class='co'>##     (1-B)^2(1+B+...+B^5) = (1-B)(1-B^6)</span>
<span class='co'>##     (  compare to (1-B)(1-B^{12}) = (1-B)(1-B^6)(1+B^6) ) </span>
<span class='va'>ap3.base</span> <span class='op'>&lt;-</span> <span class='fu'>sarima</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>AirPassengers</span><span class='op'>)</span> <span class='op'>~</span> 
                   <span class='fl'>0</span> <span class='op'>|</span> <span class='fu'>ma</span><span class='op'>(</span><span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.3</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>sma</span><span class='op'>(</span><span class='fl'>12</span>,<span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>i</span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>s</span><span class='op'>(</span><span class='fl'>6</span><span class='op'>)</span>, 
                   ss.method <span class='op'>=</span> <span class='st'>"base"</span><span class='op'>)</span>

<span class='co'>## further unit roots, equivalent specifications for the airline model</span>
<span class='va'>tmp.su</span> <span class='op'>&lt;-</span> <span class='fu'>sarima</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>AirPassengers</span><span class='op'>)</span> <span class='op'>~</span> 
                 <span class='fl'>0</span> <span class='op'>|</span> <span class='fu'>ma</span><span class='op'>(</span><span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.3</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>sma</span><span class='op'>(</span><span class='fl'>12</span>,<span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>i</span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>s</span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>su</span><span class='op'>(</span><span class='fl'>12</span>,<span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>)</span>, 
                 ss.method <span class='op'>=</span> <span class='st'>"base"</span><span class='op'>)</span>
<span class='va'>tmp.su</span><span class='op'>$</span><span class='va'>interna</span><span class='op'>$</span><span class='va'>delta_poly</span>
</div><div class='output co'>#&gt; List of polynomials:
#&gt; [[1]]
#&gt; 1 - x 
#&gt; 
#&gt; [[2]]
#&gt; 1 + x 
#&gt; 
#&gt; [[3]]
#&gt; 1 - 1.732051*x + x^2 
#&gt; 
#&gt; [[4]]
#&gt; 1 - x + x^2 
#&gt; 
#&gt; [[5]]
#&gt; 1 + x^2 
#&gt; 
#&gt; [[6]]
#&gt; 1 + x + x^2 
#&gt; 
#&gt; [[7]]
#&gt; 1 + 1.732051*x + x^2 
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/prod.html'>prod</a></span><span class='op'>(</span><span class='va'>tmp.su</span><span class='op'>$</span><span class='va'>interna</span><span class='op'>$</span><span class='va'>delta_poly</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 1 + 8.881784e-16*x^3 - 1.332268e-15*x^4 + 1.776357e-15*x^5 - 1.776357e-15*x^7 +  
#&gt; 1.332268e-15*x^8 - 8.881784e-16*x^9 - x^12 </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/zapsmall.html'>zapsmall</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/prod.html'>prod</a></span><span class='op'>(</span><span class='va'>tmp.su</span><span class='op'>$</span><span class='va'>interna</span><span class='op'>$</span><span class='va'>delta_poly</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;  [1]  1  0  0  0  0  0  0  0  0  0  0  0 -1</div><div class='input'><span class='va'>tmp.su</span>
</div><div class='output co'>#&gt; *Sarima model*
#&gt; Call:
#&gt; sarima(model = log(AirPassengers) ~ 0 | ma(1, c(-0.3)) + sma(12, 1, c(-0.1)) + 
#&gt;     i(2) + s(2) + su(12, 1:5), ss.method = "base")
#&gt; 
#&gt; Unit root terms:
#&gt;      (1 - B)^2(1 + B)(1 - 1.73205080756888*B + B^2)(1 - B + B^2)(1 + B^2)(1 + B + B^2)(1 + 1.73205080756888*B + B^2)
#&gt; 
#&gt; Coefficients:
#&gt;           ma1     sma1
#&gt;       -0.4015  -0.5615
#&gt; s.e.   0.1072   0.1068
#&gt; 
#&gt; sigma^2 estimated as 0.001347:  log likelihood = 169.3,  aic = -332.61</div><div class='input'>
<span class='va'>tmp.u</span> <span class='op'>&lt;-</span> <span class='fu'>sarima</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>AirPassengers</span><span class='op'>)</span> <span class='op'>~</span> 
                <span class='fl'>0</span> <span class='op'>|</span> <span class='fu'>ma</span><span class='op'>(</span><span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.3</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>sma</span><span class='op'>(</span><span class='fl'>12</span>,<span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>i</span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>s</span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>u</span><span class='op'>(</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>12</span><span class='op'>)</span>, 
                ss.method <span class='op'>=</span> <span class='st'>"base"</span><span class='op'>)</span>
<span class='va'>tmp.u</span>
</div><div class='output co'>#&gt; *Sarima model*
#&gt; Call:
#&gt; sarima(model = log(AirPassengers) ~ 0 | ma(1, c(-0.3)) + sma(12, 1, c(-0.1)) + 
#&gt;     i(2) + s(2) + u((1:5)/12), ss.method = "base")
#&gt; 
#&gt; Unit root terms:
#&gt;      (1 - B)^2(1 + B)(1 - 1.73205080756888*B + B^2)(1 - B + B^2)(1 + B^2)(1 + B + B^2)(1 + 1.73205080756888*B + B^2)
#&gt; 
#&gt; Coefficients:
#&gt;           ma1     sma1
#&gt;       -0.4015  -0.5615
#&gt; s.e.   0.1072   0.1068
#&gt; 
#&gt; sigma^2 estimated as 0.001347:  log likelihood = 169.3,  aic = -332.61</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Georgi N. Boshnakov, Jamie Halliday.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


